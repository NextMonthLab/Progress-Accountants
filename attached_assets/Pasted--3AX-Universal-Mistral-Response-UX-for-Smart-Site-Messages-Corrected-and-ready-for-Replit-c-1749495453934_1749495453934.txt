ğŸ“œ 3AX â†’ Universal Mistral Response UX for Smart Site Messages

ğŸ‘‰ Corrected and ready for Replit (copy this fully):

â¸»

ğŸ‘‰ Now that the core Messages pipeline + SendGrid hooks are in place:

Please implement this final UX and intelligence layer:

â¸»

1ï¸âƒ£ Mistral Response UX â€” Identity-Aware:

âœ… Add a toggle in Admin > Messages tab:
	â€¢	Label: Auto-respond to new messages with AI
	â€¢	Default: OFF

âœ… When ON:
	â€¢	For each new message received:
	â€¢	System triggers POST /api/ai/respond-to-message.
	â€¢	Mistral 7B is instructed to:
	â€¢	Read the Business Identity for this Smart Site (from the SOT).
	â€¢	Generate a polite, warm holding pattern response in the businessâ€™ tone of voice.
	â€¢	Clearly state the message was received and a human will follow up.
	â€¢	If Business Identity is missing, use a neutral, friendly business tone.

âœ… Generated response is stored in: messages.ai_response.

âœ… Response is displayed in Messages tab, alongside the original message:
	â€¢	Label: AI Auto-Response Sent
	â€¢	Show timestamp + response text.

âœ… Response is also sent to the original sender via SendGrid.

â¸»

2ï¸âƒ£ Supporting Endpoint:

âœ… Implement:

POST /api/ai/respond-to-message

Input:

{
  "message_id": "<ID of message>",
  "business_id": "<BusinessID>",
  "business_identity": "<Business Identity text>",
  "message_content": "<User message content>"
}

Expected Output:

{
  "ai_response": "<Generated AI response text>",
  "timestamp": "<UTC timestamp>"
}

âœ… Behavior:
	â€¢	Calls Mistral 7B (Hetzner API).
	â€¢	Provides context:
	â€¢	Business Identity
	â€¢	Message content
	â€¢	Receives high-quality polite AI response.
	â€¢	Stores result in messages.ai_response.
	â€¢	Triggers SendGrid send to user.

â¸»

3ï¸âƒ£ Summary of Why:

âœ… Makes Smart Sites feel intelligent and responsive.

âœ… Ensures each Smart Site reflects its own tone and brand voice â†’ not generic.

âœ… Adds huge value for clients:
	â€¢	No backend setup required.
	â€¢	AI handles first reply â†’ improves customer experience.

âœ… Works for any business, not just Progress.

â¸»

Final Notes:
	â€¢	You must use Business Identity (from SOT) as primary context source.
	â€¢	If missing, fallback to safe neutral tone.
	â€¢	DO NOT hardcode Progress tone â€” this must be universal for all Smart Sites.
	â€¢	Response should always act as holding message, not as a full conversation starter.
